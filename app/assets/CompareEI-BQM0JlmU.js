import{d as F,r as k,G as A,ai as U,w as x,B as v,o as m,c as C,l as f,t as i,g as n,u as p,a as g,b as h,v as j,e as z,p as N,S as E,cR as _,cS as M}from"./index-B9ncFhZ9.js";import{_ as P}from"./ComparisonTable.vue_vue_type_script_setup_true_lang--VMzfCjq.js";import"./utils-BUzwWt9V.js";const R={key:0,style:{color:"var(--text-color-secondary)"}},G=F({__name:"CompareEI",props:{id:{},signalType:{},type:{}},setup(I){const c=I,u=k(),y=k(""),d=k(),a=A(new U({url:"/check_EI_neighbor_tk"}));a.getParams={id:c.id,signalType:c.signalType,type:c.type},a.get(),x(()=>a.data,t=>{d.value=t}),x(()=>a.error,t=>{const e=t==null?void 0:t.response;(e==null?void 0:e.status)===404?u.value=_.NOT_FOUND:(e==null?void 0:e.status)===401?u.value=e==null?void 0:e.data:(e==null?void 0:e.status)===422?(a.data=e.data,y.value=_.BAD_EI):(e==null?void 0:e.status)===400?u.value=_.INSUFFICIENT_PARAMS:u.value=M.DEFAULT});const O=v(()=>{var t,e,l,s;return[{header:"Параметр",field:"param",sortable:!0},{header:`ЭИ на tk = ${(e=(t=a.data)==null?void 0:t.time)==null?void 0:e.tk}`,field:"curr"},{header:`ЭИ на tk = ${(s=(l=a.data)==null?void 0:l.time)==null?void 0:s.neighborTk}`,field:"neighbor"}]}),B=v(()=>{var t,e,l,s;return[{header:`ЭИ на tk = ${(e=(t=a.data)==null?void 0:t.time)==null?void 0:e.tk} после пересчета на границу tb`,field:"currBorder"},{header:`ЭИ на tk = ${(s=(l=a.data)==null?void 0:l.time)==null?void 0:s.neighborTk} после пересчета на границу tb`,field:"neighborBorder"}]}),D=[{header:"Разница",field:"diff"},{header:"Пороговое значение",field:"threshold"}],S=v(()=>{var t;return[...O.value,...(t=a.data)!=null&&t.isTbEqual?[]:B.value,...D]}),$=v(()=>{var t;return(t=a.data)!=null&&t.result?a.data.result.map(({param:e,isValid:l,...s})=>["x","y","z","Vx","Vy","Vz"].includes(e)?{...Object.entries(s).reduce((r,T)=>({...r,[T[0]]:T[1].toFixed(3)}),{}),param:e,isValid:l}:{...Object.entries(s).reduce((o,r)=>typeof r[1]=="number"?{...o,[r[0]]:r[1].toExponential(3)}:typeof r[1]=="string"?{...o,[r[0]]:r[1]}:{...o,[r[0]]:N(r[1])},{}),param:e,isValid:l}):[]});return(t,e)=>{var l,s,b,o;return m(),C("div",null,[d.value?(m(),C("div",R,[f("p",null,"Тип сигнала: "+i(c.signalType),1),f("p",null,"Системный номер: "+i((l=d.value)==null?void 0:l.sysNum)+" ("+i((s=d.value)==null?void 0:s.nkaNum)+")",1),f("p",null,[e[0]||(e[0]=n("t")),e[1]||(e[1]=f("sub",null,"k",-1)),n(" (ОМВ) кадра = "+i((b=d.value)==null?void 0:b.time.tk),1)]),f("p",null,[e[2]||(e[2]=n(" Время t")),e[3]||(e[3]=f("sub",null,"k",-1)),n(" (ОМВ): "+i(p(N)((o=d.value)==null?void 0:o.time.timestamp)),1)]),y.value?(m(),g(p(E),{key:0,severity:"warn",closable:!1},{default:h(()=>[n(i(y.value),1)]),_:1})):j("",!0),z(P,{columns:S.value,data:$.value,"is-loading":a.loading},null,8,["columns","data","is-loading"])])):u.value?(m(),g(p(E),{key:1,severity:"error",closable:!1},{default:h(()=>[n(i(u.value),1)]),_:1})):(m(),g(p(E),{key:2,severity:"info",closable:!1},{default:h(()=>e[4]||(e[4]=[n("Отсутствуют данные о сравнении ЭИ")])),_:1}))])}}});export{G as default};
