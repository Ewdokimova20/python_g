import{N as w,d0 as y,p as C,d as O,B as T,o as t,a as S,b as I,u as p,v as h,am as q,c as r,h as k,f as R,g as E,t as _,F as L,j as Q,X as Z,Y as J,Z as F,l as v,r as $,aE as X,d1 as M,e as g,d2 as ee,d3 as te,P as se,O as ae,_ as Y,S as B,a6 as re,Q as H,R as le,G as ne,ai as oe,w as z,an as ie,d4 as W,aA as K,aO as de,d5 as U}from"./index-B9ncFhZ9.js";import{_ as j}from"./OpenNewTabButton.vue_vue_type_script_setup_true_lang-N3oNufr4.js";import{s as ue}from"./inputswitch.esm-v0smpIrf.js";const ce={[w.L1OF]:"/di/l1of",[w.L2OF]:"/di/l2of",[w.L1SF]:"/di/l1sf",[w.L1OCd]:"/di/l1oc",[w.L1SCd]:"/di/l1sc",[w.L2SCd]:"/di/l2sc",[w.L3OCd]:"/di/l3oc",[w.L2_CSI]:"/di/l2ksi"},A=[{field:"dbTimestamp",header:"Время записи в БД",sortable:!0,handler:C},{field:"timestamp",header:"Время кадра",sortable:!0,handler:C},{field:"num",header:"Номер кадра",sortable:!1},{field:"tk",header:"tk",sortable:!0}],P=[{field:"dbTimestamp",header:"Время записи в БД",sortable:!0,handler:C},{field:"timestamp",header:"Время кадра",sortable:!0,handler:C},{field:"tk",header:"ОМВ стр. 10",sortable:!0}],pe=[{field:"dbTimestamp",header:"Время записи в БД",sortable:!0,handler:C},{field:"timestamp",header:"Время кадра",sortable:!0,handler:C},{field:"type",header:"Тип строки",sortable:!1},{field:"tk",header:"ОМВ",sortable:!0}],me={[y.L1OF]:A,[y.L2OF]:A,[y.L1SF]:A,[y.L1OCd]:P,[y.L3OCd]:P,[y.L1SCd]:P,[y.L2SCd]:P,[y.L2KSI]:pe},fe=O({__name:"DIListTable",props:{diList:{},modelValue:{}},emits:["update:modelValue"],setup(n,{emit:e}){const s=n,d=q("currentSignalType"),a=e;function l(i){a("update:modelValue",i)}const c=T(()=>me[d.value].filter(i=>i.isNotShown!==!0));return(i,u)=>s.diList?(t(),S(p(Q),{key:0,selection:s.modelValue,value:s.diList,"data-key":"frameId","responsive-layout":"scroll","selection-mode":"single","sort-field":"timestamp",paginator:!0,rows:8,"page-link-size":3,"sort-order":-1,"onUpdate:selection":l},{default:I(()=>[(t(!0),r(L,null,k(c.value,o=>(t(),S(p(R),{key:o.field,field:o.field,header:o.header,sortable:o.sortable??!1},{body:I(({data:m})=>[E(_(o.handler?o.handler(m[o.field]):m[o.field]),1)]),_:2},1032,["field","header","sortable"]))),128))]),_:1},8,["selection","value"])):h("",!0)}});var _e=`
.p-progress-spinner {
    position: relative;
    margin: 0 auto;
    width: 100px;
    height: 100px;
    display: inline-block;
}

.p-progress-spinner::before {
    content: '';
    display: block;
    padding-top: 100%;
}

.p-progress-spinner-svg {
    height: 100%;
    transform-origin: center center;
    width: 100%;
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    margin: auto;
}
`,ge={root:"p-progress-spinner",spinner:"p-progress-spinner-svg",circle:"p-progress-spinner-circle"},he=Z(_e,{name:"progressspinner",manual:!0}),ve=he.load,be={name:"BaseProgressSpinner",extends:J,props:{strokeWidth:{type:String,default:"2"},fill:{type:String,default:"none"},animationDuration:{type:String,default:"2s"}},css:{classes:ge,loadStyle:ve},provide:function(){return{$parentInstance:this}}},V={name:"ProgressSpinner",extends:be,computed:{svgStyle:function(){return{"animation-duration":this.animationDuration}}}},ye=["fill","stroke-width"];function Ie(n,e,s,d,a,l){return t(),r("div",F({class:n.cx("root"),role:"progressbar"},n.ptm("root"),{"data-pc-name":"progressspinner"}),[(t(),r("svg",F({class:n.cx("spinner"),viewBox:"25 25 50 50",style:l.svgStyle},n.ptm("spinner")),[v("circle",F({class:n.cx("circle"),cx:"50",cy:"50",r:"20",fill:n.fill,"stroke-width":n.strokeWidth,strokeMiterlimit:"10"},n.ptm("circle")),null,16,ye)],16))],16)}V.render=Ie;const De={class:"flex justify-content-start mb-3"},Se={class:"mr-4"},we=["innerHTML"],Le={key:1},$e={key:1,class:"string-list__progress"},ke=O({__name:"DITableView",props:{data:{},isLoading:{type:Boolean},signalType:{},columns:{},error:{},rawDI:{}},setup(n){const e=n,s=$();return X(()=>{var d;if(e.data&&((d=e.data)!=null&&d.params))if(s.value=[],e.signalType!==y.L2KSI){const{alm:a,...l}=e.data.params,{m:c,...i}=l,u=Object.entries(i??{}).map(([m,b])=>({...b,name:m})),o=Object.values(a??{}).flatMap(m=>Object.entries(m).filter(([b])=>b!=="m").map(([b,f])=>({...f,name:b})));s.value=[...u,...o]}else{const a=Object.entries(e.data.params).map(([l,c])=>({...c,name:l}));s.value=a}}),(d,a)=>{var l,c,i,u;return t(),r(L,null,[v("div",De,[v("span",Se,"Время кадра (псевдокадра) tk: "+_(((c=(l=e.data)==null?void 0:l.meta)==null?void 0:c.tkTimeFormat)??"Отсутствует"),1),v("span",null,"Время tb: "+_(((u=(i=e.data)==null?void 0:i.meta)==null?void 0:u.tbTimeFormat)??"Отсутствует"),1)]),!e.isLoading&&e.data?(t(),S(p(Q),{key:0,value:s.value,"table-style":"min-width: 50rem",class:"p-datatable-sm",scrollable:!0,"scroll-height":"70vh"},{default:I(()=>[(t(!0),r(L,null,k(e.columns.filter(o=>o.field==="name"),(o,m)=>(t(),S(p(R),{key:m,field:o.field,header:o.header,sortable:o.sortable??!1},{body:I(({data:{name:b}})=>[p(M)[e.signalType][b]?(t(),r("span",{key:0,innerHTML:p(M)[e.signalType][b]},null,8,we)):(t(),r("span",Le,_(b),1))]),_:2},1032,["field","header","sortable"]))),128)),(t(!0),r(L,null,k(e.columns.filter(o=>o.field!=="name"),(o,m)=>(t(),S(p(R),{key:m,field:o.field,header:o.header,sortable:o.sortable??!1},null,8,["field","header","sortable"]))),128))]),_:1},8,["value"])):e.isLoading?(t(),r("div",$e,[g(p(V))])):h("",!0)],64)}}}),Te={"00":"-","01":"ВНКУ1",10:"ВНКУ2",11:"ВНКУ3","0100":"ВНКУ1","0010":"ВНКУ2","0110":"ВНКУ3","010":"ВНКУ1","001":"ВНКУ2","011":"ВНКУ3"},Ce=n=>Te[n],Oe=n=>ee.includes(n)?"bn":te.includes(n)?"p1":null,Ne={class:"table p-component"},Ee={class:"table__row"},Fe={key:0,class:"pi pi-exclamation-triangle mr-2",style:{color:"#cc8925","font-size":"1rem"}},xe=["innerHTML"],Be={key:2},Pe={class:"table__row"},Me={key:0,class:"table__row"},Ue=O({__name:"ShowString",props:{frameString:{},hasError:{type:Boolean},showRaw:{type:Boolean}},setup(n){const e=n,s=q("currentSignalType"),d=(a,l)=>{if(a){const c=Number.isInteger(+a.val),i=l==="x"||l==="y"||l==="z",u=s.value===y.L2KSI,o=l===Oe(s.value),m=Ce(a.raw);return o?`${a.raw} (${m??"-"})`:c||i?String(u?a.val:+a.val):(+a.val).toExponential(4)}return""};return(a,l)=>{const c=se("tooltip");return t(),r("table",Ne,[v("tr",Ee,[(t(!0),r(L,null,k(e.frameString,(i,u)=>(t(),r("th",{key:u,class:"table__head-cell"},[(u==="m"||u==="cMB")&&e.hasError?ae((t(),r("i",Fe,null,512)),[[c,"Ошибка в строке",void 0,{left:!0}]]):h("",!0),p(M)[p(s)][u]?(t(),r("span",{key:1,innerHTML:p(M)[p(s)][u]},null,8,xe)):(t(),r("span",Be,_(u),1))]))),128))]),v("tr",Pe,[(t(!0),r(L,null,k(e.frameString,(i,u)=>(t(),r("td",{key:u,class:"table__cell"},_(d(i,u)),1))),128))]),e.showRaw?(t(),r("tr",Me,[(t(!0),r(L,null,k(e.frameString,(i,u)=>(t(),r("td",{key:u,class:"table__cell table__cell_type_raw"},_(i==null?void 0:i.raw),1))),128))])):h("",!0)])}}}),je=Y(Ue,[["__scopeId","data-v-9af939c2"]]),Ae={key:0},Re={class:"flex align-items-center justify-content-between mb-3"},Ke={class:"mr-4"},Ve={class:"string-list pb-3"},Ge={key:1,class:"string-list__progress"},He=O({__name:"DIFrameView",props:{data:{},isLoading:{type:Boolean},signalType:{},error:{},rawDI:{}},setup(n){const e=n,s=$(!1);return(d,a)=>{var l,c;return!e.isLoading&&e.data?(t(),r("div",Ae,[v("div",Re,[v("span",Ke,"Время кадра (псевдокадра) tk: "+_(((l=e.data.meta)==null?void 0:l.tkTimeFormat)??"Отсутствует"),1),v("span",null,"Время tb: "+_(((c=e.data.meta)==null?void 0:c.tbTimeFormat)??"Отсутствует"),1),a[1]||(a[1]=v("label",{for:"show-raw",class:"mr-3 ml-auto"},"Отобразить побитовую расшифровку",-1)),g(p(ue),{id:"show-raw",modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=i=>s.value=i)},null,8,["modelValue"])]),v("div",Ve,[(t(!0),r(L,null,k(e.data.content,(i,u)=>{var o;return t(),r("div",{key:u,class:"string-list__item"},[g(je,{"frame-string":i,"has-error":(o=e.data.meta)==null?void 0:o.stringErrors[u],"show-raw":s.value||!1},null,8,["frame-string","has-error","show-raw"])])}),128))])])):e.isLoading?(t(),r("div",Ge,[g(p(V))])):h("",!0)}}}),ze=Y(He,[["__scopeId","data-v-8a6bc592"]]),We={key:2},qe={key:0},Qe={key:0},Xe={key:1,style:{"overflow-x":"auto"}},Ye={key:2},Ze={key:0},Je={key:0},et={key:1,style:{"overflow-x":"auto"}},tt=O({__name:"ShowDI",props:{data:{},isLoading:{type:Boolean},signalType:{},error:{},rawDI:{}},setup(n){const e=n,s=[{field:"name",header:"Параметр",sortable:!1},{field:"val",header:"Значение",sortable:!0},{field:"description",header:"Описание"}];return(d,a)=>(t(),S(p(le),null,{default:I(()=>[g(p(H),{header:"Кадр"},{default:I(()=>[d.data?e.error?(t(),r("div",We,[g(p(B),{severity:"error",closable:!1},{default:I(()=>[E(_(d.error),1)]),_:1}),d.rawDI?(t(),r("div",qe,[e.rawDI.num?(t(),r("p",Qe,"Тип строки: "+_(e.rawDI.num),1)):h("",!0),e.rawDI.content?(t(),r("p",Xe," Содержимое: "+_(e.rawDI.content),1)):h("",!0)])):h("",!0)])):(t(),S(ze,re(F({key:1},d.$props)),null,16)):(t(),S(p(B),{key:0,severity:"info",closable:!1},{default:I(()=>a[0]||(a[0]=[E("Нет данных для отображения")])),_:1}))]),_:1}),g(p(H),{header:"Таблица"},{default:I(()=>{var l;return[d.data?(l=d.data)!=null&&l.params&&!e.error?(t(),S(ke,F({key:1},d.$props,{columns:s}),null,16)):(t(),r("div",Ye,[g(p(B),{severity:"error",closable:!1},{default:I(()=>[E(_(d.error),1)]),_:1}),d.rawDI?(t(),r("div",Ze,[e.rawDI.num?(t(),r("p",Je,"Тип строки: "+_(e.rawDI.num),1)):h("",!0),e.rawDI.content?(t(),r("p",et," Содержимое: "+_(e.rawDI.content),1)):h("",!0)])):h("",!0)])):(t(),S(p(B),{key:0,severity:"info",closable:!1},{default:I(()=>a[1]||(a[1]=[E("Нет данных для отображения")])),_:1}))]}),_:1})]),_:1}))}}),st={class:"grid"},at={class:"col-3 flex flex-column"},rt={key:0,class:"flex flex-column",style:{gap:"1em"}},it=O({__name:"DISearchResult",props:{signalType:{},data:{}},setup(n){const e=n,s=$(),d=$({num:void 0,content:""}),a=$(""),l=T(()=>e.signalType),c=$(),i=T(()=>l.value!==y.L2KSI),u=T(()=>ce[l.value]),o=T(()=>{var f;return`${u.value}/${(f=s.value)==null?void 0:f.frameId}`});ie("currentSignalType",l);const m=ne(new oe({url:o.value}));function b(){m.url=o.value,m.get()}return z(()=>m.error,f=>{var N,x,G;if(f){const D=f==null?void 0:f.response;D?(D==null?void 0:D.status)===404?a.value=W.NOT_FOUND:(D==null?void 0:D.status)===401&&(a.value=(N=D.data)==null?void 0:N.message,d.value={num:(x=D.data)==null?void 0:x.string_num,content:(G=D.data)==null?void 0:G.content}):f!=null&&f.request?a.value=K.NO_CONNECTION:a.value=W.DEFAULT}else a.value=""}),z(()=>s.value,f=>{f!=null&&(b(),c.value={id:f.frameId,signalType:de[l.value]})}),(f,N)=>(t(),r("div",st,[v("div",at,[g(fe,{modelValue:s.value,"onUpdate:modelValue":N[0]||(N[0]=x=>s.value=x),class:"mb-3 flex-grow-0",style:{"flex-basis":"500px"},"di-list":e.data},null,8,["modelValue","di-list"]),s.value!==null&&Object.values(c.value??{}).length!==0&&i.value?(t(),r("div",rt,[g(j,{label:"Сравнить с СИ","component-name":"CompareDIandSI",params:c.value,disabled:!s.value},null,8,["params","disabled"]),g(j,{label:"Сравнить c ЭИ на след. tk","component-name":"CompareEI",params:{...c.value,type:"next"},disabled:!s.value},null,8,["params","disabled"]),g(j,{label:"Сравнить c ЭИ на предыд. tk","component-name":"CompareEI",params:{...c.value,type:"previous"},disabled:!s.value},null,8,["params","disabled"])])):h("",!0)]),g(tt,{class:"col-9",data:m.data,"is-loading":m.loading,error:a.value,"signal-type":l.value,"raw-d-i":d.value},null,8,["data","is-loading","error","signal-type","raw-d-i"])]))}});function dt(n){const e=$(null),s=l=>{e.value=l},d=()=>{e.value=null},a=T(()=>e.value!=null);return X(()=>{var l,c;if(n.error){const i=(l=n.error)==null?void 0:l.response;i?i.status===404?s(U.NOT_FOUND):i.status===400?s(K.INSUFFICIENT_PARAMS):s(U.DEFAULT):(c=n.error)!=null&&c.request?s(K.NO_CONNECTION):s(U.DEFAULT)}else d()}),{error:e,hasError:a,resetError:d}}export{ce as D,it as _,dt as u};
