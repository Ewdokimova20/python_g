import{D as Y,A as j,d as M,B as m,o as n,c as a,l as s,t as d,v as k,u as E,p as G,g as U,y as L,_ as V,k as H,r as q,s as J,C as K,E as Q,G as tt,F as y,h as D,H as et,e as Z,b as st,I as ot,V as lt}from"./index-B9ncFhZ9.js";var B=(u=>(u[u.UNDEFINED=0]="UNDEFINED",u[u.EXPECTED_VISIBLE_ABSENT=1]="EXPECTED_VISIBLE_ABSENT",u[u.EXPECTED_VISIBLE_PRESENT_WITH_DELAY=2]="EXPECTED_VISIBLE_PRESENT_WITH_DELAY",u[u.EXPECTED_VISIBLE_PRESENT_WITHOUT_DELAY=3]="EXPECTED_VISIBLE_PRESENT_WITHOUT_DELAY",u[u.EXPECTED_NOT_VISIBLE_PRESENT=4]="EXPECTED_NOT_VISIBLE_PRESENT",u[u.NOT_EXPECTED=5]="NOT_EXPECTED",u))(B||{});const z={0:"",1:"red",2:"orange",3:"green",4:"purple",5:"gray"},nt={0:"Состояние не определено",1:"НКА в ЗРВ с заданного УМ, данные отсутствуют",2:"НКА в ЗРВ с заданного УМ, данные поступают с задержкой",3:"НКА в ЗРВ с заданного УМ, данные поступают",4:"НКА не в ЗРВ с заданного УМ, данные поступают",5:"По данному сигналу данные не должны поступать"},F={di:{timeLabel:"Время строки ЦИ",receivedLabel:"Получено строк ЦИ в ЗРВ / Должно быть:",url:"/di_reception_data",signals:Y},meas:{timeLabel:"Время измерения",receivedLabel:"Получено измерений в ЗРВ / Должно быть:",url:"/meas_reception_data",signals:j}},at={class:"max-w-25rem"},rt={key:0,class:"measurement text-sm"},ut={class:"text-center"},dt={class:"text-center"},it={class:"text-center"},ct={class:"text-center"},Et={class:"text-center"},pt={class:"text-center"},_t={class:"text-xs w-full"},mt={key:0},ft={class:"font-bold text-primary w-5"},vt={class:"text-right"},bt={class:"font-bold text-primary"},xt={class:"font-bold text-right"},Ct={key:1},Tt={class:"text-right font-bold"},yt={key:2},Dt={class:"text-right"},Nt=M({__name:"ReceptionControlPopup",props:{data:{},mode:{}},setup(u){const i=u,{timeLabel:N,receivedLabel:f}=F[i.mode],I=m(()=>{var e;return(e=i.data)==null?void 0:e.timestamp});m(()=>{var e;return(e=i.data)==null?void 0:e.lastUpdate});const v=m(()=>{var e;return(e=i.data)==null?void 0:e.expectedZoneCount}),o=m(()=>{var e;return(e=i.data)==null?void 0:e.zoneCount}),p=m(()=>{var e;return(e=i.data)==null?void 0:e.receptionStatus}),_=m(()=>{var e;return(e=i.data)==null?void 0:e.isZoneCountSufficient}),c=m(()=>{var e;return(e=i.data)==null?void 0:e.measurement}),g=m(()=>{var e;return(e=i.data)==null?void 0:e.hasTooManyErrors}),P=m(()=>{var e;return(e=i.data)==null?void 0:e.errorCount}),h=m(()=>Object.entries(c.value??{}).length>0);return(e,t)=>{var l,r,b,x,C,T;return n(),a("article",at,[h.value?(n(),a("table",rt,[t[12]||(t[12]=s("tr",null,[s("th",{class:"font-bold"},"Параметр"),s("th",null,"Значение"),s("th",null,"Ед. изм.")],-1)),s("tr",null,[t[0]||(t[0]=s("td",{class:"font-bold"},"Псевдодальность:",-1)),s("td",ut,d(((l=c.value)==null?void 0:l.pseudorange)??"-"),1),t[1]||(t[1]=s("td",{class:"text-center"},"м",-1))]),s("tr",null,[t[2]||(t[2]=s("td",{class:"font-bold"},"Псевдоскорость:",-1)),s("td",dt,d(((r=c.value)==null?void 0:r.pseudospeed)??"-"),1),t[3]||(t[3]=s("td",{class:"text-center"},"м/с",-1))]),s("tr",null,[t[4]||(t[4]=s("td",{class:"font-bold"},"Доплеровский сдвиг:",-1)),s("td",it,d(((b=c.value)==null?void 0:b.carrierShift)??"-"),1),t[5]||(t[5]=s("td",{class:"text-center"},"Гц",-1))]),s("tr",null,[t[6]||(t[6]=s("td",{class:"font-bold"},"Фаза несущей частоты:",-1)),s("td",ct,d(((x=c.value)==null?void 0:x.carrierPhase)??"-"),1),t[7]||(t[7]=s("td",{class:"text-center"},"циклы",-1))]),s("tr",null,[t[8]||(t[8]=s("td",{class:"font-bold"},"Литера нав. сигнала КА:",-1)),s("td",Et,d(((C=c.value)==null?void 0:C.letter)??"-"),1),t[9]||(t[9]=s("td",{class:"text-center"},"-",-1))]),s("tr",null,[t[10]||(t[10]=s("td",{class:"font-bold"},"Соотношение сигнал/шум:",-1)),s("td",pt,d(((T=c.value)==null?void 0:T.snr)??"-"),1),t[11]||(t[11]=s("td",{class:"text-center"},"дБ Гц",-1))])])):k("",!0),s("table",_t,[I.value?(n(),a("tr",mt,[s("td",ft,d(E(N)),1),s("td",vt,d(E(G)(I.value)),1)])):k("",!0),s("tr",null,[s("td",bt,d(E(f)),1),s("td",xt,[U(d(`${o.value??"-"} / ${v.value??"-"}`)+" ",1),o.value&&v.value?(n(),a("span",{key:0,class:L(_.value===!0?"text-green-600":"text-red-600")},"("+d((o.value/v.value*100).toFixed(0))+"%)",3)):k("",!0)])]),p.value!=null?(n(),a("tr",Ct,[t[13]||(t[13]=s("td",{class:"font-bold text-primary"},"Состояние:",-1)),s("td",Tt,d(E(nt)[p.value]),1)])):k("",!0),P.value!=null&&o.value!=null?(n(),a("tr",yt,[t[14]||(t[14]=s("td",{class:"font-bold text-primary"},"Строк с ошибками:",-1)),s("td",Dt,[U(d(`${P.value} / ${o.value??"-"}`)+" ",1),o.value!=0?(n(),a("span",{key:0,class:L(["font-bold",g.value===!1?"text-green-600":"text-red-600"])},"("+d((P.value/o.value*100).toFixed(0))+"%)",3)):k("",!0)])])):k("",!0)])])}}}),It=V(Nt,[["__scopeId","data-v-1167142d"]]),gt={class:"nka-column pl-1 pr-1 font-semibold text-sm"},St=["onMouseover"],kt=M({__name:"ReceptionControlTable",props:{bisId:{},mode:{}},setup(u){const i=u,N=H(),f=q(),{url:I,signals:v}=F[i.mode],o=J({url:I,startImmediately:!1,updateRate:3e3});K(()=>{o.getParams={bisId:i.bisId},o.get(),o.start()}),Q(()=>o.stop());const p=tt({nka:null,signal:null}),_=m(()=>{var l,r,b,x,C,T,S,O,$,X,w,A;const{nka:e,signal:t}=p;if(e!=null&&t!=null){if(((r=(l=o.data)==null?void 0:l[e])==null?void 0:r[t])!=null){const R=Object.entries(((x=(b=o.data)==null?void 0:b[e])==null?void 0:x[t])??{}).length>0,W=((T=(C=o.data)==null?void 0:C[e])==null?void 0:T[t].receptionStatus)!==B.UNDEFINED;return R&&W?(O=(S=o.data)==null?void 0:S[e])==null?void 0:O[t]:null}return((X=($=o.data)==null?void 0:$[e])==null?void 0:X[t])!==void 0?(A=(w=o.data)==null?void 0:w[e])==null?void 0:A[t]:null}return null}),c=e=>{let t="";if(e){const{receptionStatus:l,isZoneCountSufficient:r,hasTooManyErrors:b}=e;return t=z[l],b===!0&&(t=`${t} too-many-errors`),r!=null&&r===!1?`${t} alarm-on-border`:t}return t},g=e=>{if(!e)return null;const{receptionStatus:t,visibility:l,measurement:r}=e;return t===B.UNDEFINED&&l!=null&&l<lt.GUARANTEED?null:r!=null&&r.pseudorange?r==null?void 0:r.pseudorange.toFixed(0):null},P=(e,t,l)=>{p.nka=t??null,p.signal=l,_.value!==null&&f.value!==null&&f.value.show(e)},h=e=>{_.value!==null&&f.value!==null&&f.value.hide(e)};return(e,t)=>(n(),a("table",null,[s("thead",null,[s("tr",null,[t[1]||(t[1]=s("th",{rowspan:2},"НКА",-1)),(n(!0),a(y,null,D(E(v),l=>(n(),a("th",{key:l,class:"text-xs"},d(E(et)[l]),1))),128))])]),s("tbody",null,[(n(!0),a(y,null,D(E(N).nkaList??{},({sysNum:l})=>(n(),a("tr",{key:l},[s("td",gt,d(l)+" ("+d(E(N).sysNumToNkuNum(Number(l))??"-")+") ",1),(n(!0),a(y,null,D(E(v),r=>{var b,x,C,T;return n(),a("td",{key:r+"_data",class:L(["data-cell text-center text-overflow-ellipsis overflow-x-hidden",c((x=(b=E(o).data)==null?void 0:b[l])==null?void 0:x[r])]),onMouseover:S=>P(S,l,r),onMouseleave:t[0]||(t[0]=S=>h(S))},d(g((T=(C=E(o).data)==null?void 0:C[l])==null?void 0:T[r])),43,St)}),128))]))),128))]),Z(E(ot),{ref_key:"flagDataPopup",ref:f,dismissable:""},{default:st(()=>[Z(It,{data:_.value,mode:e.mode},null,8,["data","mode"])]),_:1},512)]))}}),ht=V(kt,[["__scopeId","data-v-c9ab7c8e"]]),Pt=M({__name:"ReceptionControlMiniTable",props:{tableData:{},mode:{}},setup(u){const i=u,N=H(),{signals:f}=F[i.mode],I=v=>{let o="";if(v){const{rs:p,izcs:_,htme:c}=v;return o=z[p],c!=null&&(o=c===!0?`${o} too-many-errors`:o),_!=null&&_===!1?`${o} alarm-on-border`:o}return o};return(v,o)=>(n(),a("table",null,[s("tbody",null,[i.tableData!=null?(n(!0),a(y,{key:0},D(E(N).nkaList??{},({sysNum:p})=>(n(),a("tr",{key:p},[(n(!0),a(y,null,D(E(f),_=>{var c,g;return n(),a("td",{key:_+"_data",class:L(["text-sm",I((g=(c=i.tableData)==null?void 0:c[p])==null?void 0:g[_])])},null,2)}),128))]))),128)):(n(),a(y,{key:1},D(26,p=>s("tr",{key:p},[(n(!0),a(y,null,D(E(f),_=>(n(),a("td",{key:_+"_data",class:"text-sm"}))),128))])),64))])]))}}),Bt=V(Pt,[["__scopeId","data-v-72b62ef1"]]);export{Bt as R,ht as a};
