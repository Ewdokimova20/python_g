import{Y as Q,d as A,C as te,cP as B,N as se,B as O,o as s,a as v,b as r,e as o,u as t,f as h,c as n,h as N,F as x,t as b,l as g,v as U,at as Y,p as ae,j as ne,r as D,s as q,M as X,w as Z,aG as J,m as L,g as $,S,aA as K,cQ as W,y as le,H as oe,_ as re,Q as j,R as ie}from"./index-B9ncFhZ9.js";import{g as M,a as ue}from"./utils-BUzwWt9V.js";var de={name:"BaseColumnGroup",extends:Q,props:{type:{type:String,default:null}},provide:function(){return{$parentInstance:this}}},G={name:"ColumnGroup",extends:de,render:function(){return null}},V={name:"Row",extends:Q,render:function(){return null}};const me=["innerHTML"],ce={key:1},pe=["innerHTML"],_e={key:2},fe={key:3},ye={key:4},be={key:0,class:"font-bold colspan2"},ve={key:1,class:"font-bold colspan2"},he={key:2,class:"font-bold"},ke={class:"font-bold"},Ce=A({__name:"OnlineImmediateInfoControlTable",props:{data:{},isLoading:{type:Boolean}},setup(k){const l=k;function u(_,y){return typeof y=="number"?["x","y","z","Vx","Vy","Vz","x_L3","y_L3","z_L3","dX","dY","dZ"].includes(_)?y.toFixed(3):["gamma","beta","Ax","Ay","Az","Ax_L3","Ay_L3","Az_L3"].includes(_)?y.toExponential(3):["tau"].includes(_)?y.toFixed(9):y:y}const a=["tb_timestamp","tb"],c=()=>{const _=d=>{d.colSpan=2},y=d=>{d.nextElementSibling&&d.nextElementSibling.remove()};document.querySelectorAll(".colspan2").forEach(d=>{const f=d.closest('td[role="cell"]');f&&(_(f),y(f))})};te(()=>c());const C=(_,y)=>{const e=f=>{const i=_[f].map(I=>I[y]).filter(Boolean).join(`
`);return i?`${f}:
${i}`:""};return[e(169),e(893)].filter(Boolean).join(`
`)},w=["tk_datetime","tb_datetime","x","y","z","Vx","Vy","Vz","Ax","Ay","Az","tau","beta","gamma","tk","Nt","N4","tb"],m=[{header:"Параметр",field:"param",sortable:!0},...B.map(_=>({header:se[_],field:String(_)})),{header:"СИ",field:"si",isNotShown:!0}];function p(_,y){return w.indexOf(_.param)-w.indexOf(y.param)}const T=O(()=>l.data?[...l.data.tableData].sort(p):[]),ee=_=>_?"success":"danger";return(_,y)=>(s(),v(t(ne),{class:"p-datatable-sm",value:T.value,"data-key":"param","responsive-layout":"scroll","sort-field":"param","show-gridlines":""},{default:r(()=>[o(t(G),{type:"header"},{default:r(()=>[o(t(V),null,{default:r(()=>[o(t(h),{header:m[0].header,rowspan:2},null,8,["header"]),(s(!0),n(x,null,N(m.filter(e=>e.field!=="param"&&e.field!=="si"),({header:e},d)=>(s(),v(t(h),{key:d,header:e,rowspan:2},null,8,["header"]))),128)),o(t(h),{header:"СИ","body-style":"min-width: 11rem",rowspan:1,colspan:2})]),_:1}),o(t(V),null,{default:r(()=>[o(t(h),{header:"ЭИ для L__F"}),o(t(h),{header:"ЭИ для L__Cd"})]),_:1})]),_:1}),o(t(h),{field:m[0].field,sortable:m[0].sortable,"body-style":"min-width: 10rem",rowspan:2},{body:r(({data:{param:e}})=>[e?(s(),n(x,{key:0},[t(M)(e)?(s(),n("span",{key:0,class:"font-bold",innerHTML:t(M)(e)},null,8,me)):(s(),n("span",ce,b(e),1)),g("span",{innerHTML:t(ue)(e)},null,8,pe)],64)):U("",!0)]),_:1},8,["field","sortable"]),(s(!0),n(x,null,N(m.filter(e=>e.field!=="param"&&e.field!=="si"),({field:e,sortable:d},f)=>(s(),v(t(h),{key:f,field:e,sortable:d,"body-style":"min-width: 11rem",rowspan:2},{body:r(({data:i})=>{var I,E,z,F,P,H,R;return[((I=i==null?void 0:i[e])==null?void 0:I.value)!=null?(s(),n(x,{key:0},[],64)):U("",!0),((E=i[e])==null?void 0:E.isValid)!=null?(s(),v(t(Y),{key:1,class:"text-base font-semibold",value:u(i.param,i[e].value),severity:ee((z=i[e])==null?void 0:z.isValid),style:{"min-width":"10rem"}},null,8,["value","severity"])):i.param==="tk_datetime"||i.param==="tb_datetime"?(s(),n("span",_e,b(i.param==="tk_datetime"?t(ae)((F=i[e])==null?void 0:F.value):(P=i[e])==null?void 0:P.value),1)):((H=i[e])==null?void 0:H.isValid)===null&&typeof((R=i[e])==null?void 0:R.value)=="number"?(s(),n("span",fe,b(u(i.param,i[e].value)),1)):(s(),n("span",ye,"-"))]}),_:2},1032,["field","sortable"]))),128)),o(t(h),{style:{"min-width":"15rem"}},{body:r(({data:e})=>{var d,f,i,I;return[a.includes(e==null?void 0:e.param)?(s(),n("div",be,b(((d=e==null?void 0:e.si)==null?void 0:d.phCentreFd)!=null?u(e.param,e.si.phCentreFd):"-"),1)):(e==null?void 0:e.param)==="tb_datetime"?(s(),n("div",ve,b(((f=l.data)==null?void 0:f.siTimestamp)!=null?C((i=l.data)==null?void 0:i.siTimestamp,"tb"):"-"),1)):(s(),n("span",he,b(((I=e==null?void 0:e.si)==null?void 0:I.phCentreFd)!=null?u(e.param,e.si.phCentreFd):"-"),1))]}),_:1}),o(t(h),{style:{"min-width":"15rem"}},{body:r(({data:e})=>{var d,f;return[g("span",ke,b(((f=(d=e==null?void 0:e.si)==null?void 0:d.centre)==null?void 0:f.data)!=null?u(e.param,e.si.centre.data):"-"),1)]}),_:1}),o(t(G),{type:"footer"},{default:r(()=>[o(t(V),null,{default:r(()=>{var e,d;return[o(t(h),{footer:"Время записи СИ в ЦБД:",colspan:8,"footer-style":"text-align:right"}),o(t(h),{colspan:2,footer:((e=l.data)==null?void 0:e.siTimestamp)!=null?C((d=l.data)==null?void 0:d.siTimestamp,"timestamp"):"-"},null,8,["footer"])]}),_:1})]),_:1})]),_:1},8,["value"]))}}),ge={class:"m-auto w-min"},xe={class:"flex justify-content-center mb-5 mt-4"},$e={key:0},Ie={key:1},we={key:0,class:"border-solid border-round border-1 border-300"},Ne=A({__name:"OnlineImmediateInfoControl",setup(k){const l=D(null),u=D(""),a=q({url:"/immediate_DI_and_SI_comparison",startImmediately:!1,updateRate:5e3}),c=O(()=>a.intervalID!==void 0),C=()=>{var m;if(!l.value){u.value=W.INSUFFICIENT_PARAMS;return}u.value="",a.post({sysNum:(m=l.value)==null?void 0:m.sysNum}),a.start(),a.get()},w=()=>{a.stop()};return X(()=>a.stop()),Z(()=>l.value,m=>{c.value&&m&&(a.post({sysNum:m.sysNum}),a.data=void 0)}),(m,p)=>(s(),n("article",ge,[g("div",xe,[o(J,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=T=>l.value=T),class:"w-20rem mr-4"},null,8,["modelValue"]),o(t(L),{class:"mr-4",style:{"min-width":"fit-content"},disabled:!l.value||c.value,onClick:C},{default:r(()=>[c.value?(s(),n("span",Ie,"Идет сравнение...")):(s(),n("span",$e,"Начать отображение"))]),_:1},8,["disabled"]),o(t(L),{style:{"min-width":"fit-content"},disabled:!l.value||!c.value,class:"p-button-danger",onClick:w},{default:r(()=>p[1]||(p[1]=[$("Остановить")])),_:1},8,["disabled"])]),t(a).data?(s(),n("div",we,[o(Ce,{data:t(a).data,"is-loading":t(a).loading||t(a).posting},null,8,["data","is-loading"])])):u.value?(s(),v(t(S),{key:1,severity:"error",closable:!1},{default:r(()=>[$(b(u.value),1)]),_:1})):t(a).loading||t(a).posting?(s(),v(t(S),{key:2,severity:"info",closable:!1},{default:r(()=>p[2]||(p[2]=[$("Загрузка...")])),_:1})):(s(),v(t(S),{key:3,severity:"info",closable:!1},{default:r(()=>[$(b(t(K).NO_DATA),1)]),_:1}))]))}}),Se={class:"flex gap-2"},Ae=A({__name:"AlmanacParamsTableCell",props:{almanacParams:{}},setup(k){return(l,u)=>(s(),n("div",Se,[(s(!0),n(x,null,N(l.almanacParams,(a,c)=>(s(),v(t(Y),{key:c,innerHTML:t(M)(c),style:{color:"white"},class:le({"bg-green-400":a===!0,"bg-red-400":a===!1,"surface-400":a==null})},null,8,["innerHTML","class"]))),128))]))}}),Te={class:"nka-column pl-1 pr-1 font-semibold"},De=A({__name:"OnlineAlmanacControlTable",props:{almanacData:{}},setup(k){return(l,u)=>(s(),n("table",null,[g("thead",null,[g("tr",null,[u[0]||(u[0]=g("th",{class:"nka-column border-b-2 border-black"},"НКА",-1)),(s(!0),n(x,null,N(t(B),a=>(s(),n("th",{key:a,class:"px-2 py-1 border-b-2 border-black"},b(t(oe)[a]),1))),128))])]),g("tbody",null,[(s(!0),n(x,null,N(l.almanacData,(a,c)=>(s(),n("tr",{key:c},[g("td",Te,b(c),1),(s(!0),n(x,null,N(t(B),C=>(s(),n("td",{key:C+"_data"},[o(Ae,{almanacParams:a==null?void 0:a[C]},null,8,["almanacParams"])]))),128))]))),128))])]))}}),Le=re(De,[["__scopeId","data-v-3e847fe9"]]),Ve={class:"m-auto w-min"},Be={class:"flex justify-content-center mb-5 mt-4"},Me={key:0},Oe={key:1},Ee={key:0,class:"border-solid border-round border-1 border-300"},ze=A({__name:"OnlineAlmanacControl",setup(k){const l=D(null),u=D(""),a=q({url:"/almanac_DI_and_SI_comparison",startImmediately:!1,updateRate:5e3}),c=O(()=>a.intervalID!==void 0),C=()=>{var m;if(!l.value){u.value=W.INSUFFICIENT_PARAMS;return}u.value="",a.post({sysNum:(m=l.value)==null?void 0:m.sysNum}),a.start(),a.get()},w=()=>{a.stop()};return X(()=>a.stop()),Z(()=>l.value,m=>{c.value&&m&&(a.post({sysNum:m.sysNum}),a.data=void 0)}),(m,p)=>(s(),n("div",Ve,[g("div",Be,[o(J,{modelValue:l.value,"onUpdate:modelValue":p[0]||(p[0]=T=>l.value=T),class:"w-20rem mr-4"},null,8,["modelValue"]),o(t(L),{class:"mr-4",style:{"min-width":"fit-content"},disabled:!l.value||c.value,onClick:C},{default:r(()=>[c.value?(s(),n("span",Oe,"Идет сравнение...")):(s(),n("span",Me,"Начать отображение"))]),_:1},8,["disabled"]),o(t(L),{style:{"min-width":"fit-content"},disabled:!l.value||!c.value,class:"p-button-danger",onClick:w},{default:r(()=>p[1]||(p[1]=[$("Остановить")])),_:1},8,["disabled"])]),t(a).data?(s(),n("div",Ee,[o(Le,{almanacData:t(a).data},null,8,["almanacData"])])):u.value?(s(),v(t(S),{key:1,severity:"error",closable:!1},{default:r(()=>[$(b(u.value),1)]),_:1})):t(a).loading||t(a).posting?(s(),v(t(S),{key:2,severity:"info",closable:!1},{default:r(()=>p[2]||(p[2]=[$("Загрузка...")])),_:1})):(s(),v(t(S),{key:3,severity:"info",closable:!1},{default:r(()=>[$(b(t(K).NO_DATA),1)]),_:1}))]))}}),He=A({__name:"OnlineDIControl",setup(k){return(l,u)=>(s(),v(t(ie),{class:"tabview",lazy:!0},{default:r(()=>[o(t(j),{header:"Оперативная информация"},{default:r(()=>[o(Ne)]),_:1}),o(t(j),{header:"Альманах"},{default:r(()=>[o(ze)]),_:1})]),_:1}))}});export{He as default};
