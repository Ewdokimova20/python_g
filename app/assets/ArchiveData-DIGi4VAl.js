import{R,C as x,r as z,p as S,d as g,N,b as M}from"./knp-style-BUSAdRBo.js";import{d as f,r as O,B as A,o as n,c as m,a as E,a6 as P,Z as F,u as l,v,t as H,F as B,G as w,ai as C,e as h,az as V,l as c,a8 as k,aa as I}from"./index-B9ncFhZ9.js";const K={key:1},D=f({__name:"ArchiveResidualsCharPlot",props:{yValues:{},colors:{},names:{},data:{},isAverageNeeded:{type:Boolean}},setup(y){const a=y,e=O(a.data),i={options:{animation:!1,parsing:{xAxisKey:"timestamp"},scales:{x:{type:"time",time:{tooltipFormat:"HH:mm:ss",unit:"minute",displayFormats:{minute:"DD-MMM HH:mm"}},title:{display:!0,text:"МДВ"}},y:{title:{display:!0,text:"[м]"}}},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"y"}}}}},d=A(()=>{const t={};if(e.value.available&&e.value.data){if(t.datasets=[],Object.values(e.value.data).slice(0,-1).forEach((s,o)=>{if(t.datasets[o]={},t.datasets[o].data=s,s.length!==0){const u=t.datasets[o].data[0];u!==void 0&&(t.datasets[o].label=a.names[u.nkaId],t.datasets[o].backgroundColor=a.colors[u.nkaId],t.datasets[o].parsing={yAxisKey:a.yValues})}}),a.isAverageNeeded){const o={...{label:"Средняя невязка",borderColor:"red",parsing:{yAxisKey:"average"},type:"line",pointStyle:"line",borderWidth:6,order:-1},data:e.value.data.average};t.datasets.push(o)}return t}return{datasets:[]}});typeof window<"u"&&(window.ResizeObserver=window.ResizeObserver||R),x.register(...z,S);const{scatterChartProps:r}=g.useScatterChart({chartData:d,...i});return(t,s)=>(n(),m(B,null,[e.value.available?(n(),E(l(g.ScatterChart),P(F({key:0},l(r))),null,16)):v("",!0),e.value.available?(n(),m("p",K,"Последнее обновление "+H(e.value.lastGet),1)):v("",!0)],64))}}),$={key:1},G=f({__name:"ArchiveNavSolutionPlot",props:{data:{},colors:{},names:{}},setup(y){const a=y,e=["e","n","u","dt"],i=O(a.data),d={options:{animation:!1,scales:{x:{type:"time",time:{tooltipFormat:"HH:mm:ss",unit:"minute",displayFormats:{minute:"DD-MMM HH:mm"}},title:{display:!0,text:"МДВ"}},y:{title:{display:!0,text:"E, N, U, м"},position:"left"},y2:{title:{display:!0,text:"dt, м"},position:"right"}},plugins:{zoom:{zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"y"}}}}},r=A(()=>{const s={};return i.value.isDataNotEmpty?(s.datasets=[],e.forEach((o,u)=>{var b;const p={};p.data=(b=i.value.data)==null?void 0:b.map(_=>({y:_[e[u]],x:_.timestamp})),p.label=a.names[e[u]],p.backgroundColor=a.colors[e[u]],p.yAxisID="y",s.datasets.push(p)}),s.datasets[s.datasets.length-1].yAxisID="y2",s):{datasets:[]}});typeof window<"u"&&(window.ResizeObserver=window.ResizeObserver||R),x.register(...z,S);const{scatterChartProps:t}=g.useScatterChart({chartData:r,...d});return(s,o)=>(n(),m(B,null,[i.value.available?(n(),E(l(g.ScatterChart),P(F({key:0},l(t))),null,16)):v("",!0),i.value.available?(n(),m("p",$,"Последнее обновление "+H(i.value.lastGet),1)):v("",!0)],64))}}),U={key:0},W=f({__name:"ArchiveData",setup(y){const a=w(new C({url:"/archive_residuals"})),e=w(new C({url:"/archive_solutions"}));function i(d){a.getParams=d,e.getParams=d,a.get(),e.get()}return(d,r)=>(n(),m("div",null,[h(V,{"is-with-nka":!1,"loading-state":a.loading,"is-bis-with-generalized":!1,onQueryParams:i},null,8,["loading-state"]),a.isDataNotEmpty?(n(),m("div",U,[c("div",null,[r[0]||(r[0]=c("h2",{class:"subtitle"},"Значения невязок и средняя невязка",-1)),h(D,{colors:l(N),names:l(k),"y-values":"residual","is-average-needed":!0,data:a},null,8,["colors","names","data"])]),c("div",null,[r[1]||(r[1]=c("h2",{class:"subtitle"},"Отклонение невязок от среднего",-1)),h(D,{colors:l(N),names:l(k),"y-values":"delta","is-average-needed":!1,data:a},null,8,["colors","names","data"])]),c("div",null,[r[2]||(r[2]=c("h2",{class:"subtitle"},"РНЗ",-1)),h(G,{data:e,colors:l(M),names:l(I)},null,8,["data","colors","names"])])])):v("",!0)]))}});export{W as default};
